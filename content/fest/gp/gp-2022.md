---
title: "2022 SUKEN GRAND PRIX"
date: 2022-09-18
lastmod: 2022-10-12
---

## 問題

2022 年 9 月 17・18 日 時間無制限 12 題

(注意事項)

* 一問でも解けたら採点係のところまで持ってきてください. 採点は何度でも可能です.
* 6 からは証明問題です. 答を求める問題であっても必ず証明をつけてください.
* 小学生は 4 問, 中学生は 6 問, 高校生は 8 問, OB・大学生は 10 問で殿堂入りです.

### 1

次の虫食い算を解け.

$$\def\arraystretch{1.5}
\begin{array}{cccccccccc}
&&&&&\square&\square&\square&\square&\square\\\
&&&\times&&\square&\square&\square&\square&\square\\\ \hline
&&&&&\square&\square&\square&2&1\\\
&&&\square&\square&8&\square&0&5&\\\
&&&\square&\square&\square&2&1&&\\\
&\square&5&\square&\square&2&\square&&&\\\
\square&\square&\square&\square&\square&\square&&&&\\\ \hline
\square&\square&7&\square&8&\square&5&\square&\square&\square
\end{array}$$

### 2

次の虫食い算を解け.

$$\def\arraystretch{1.5}
\begin{array}{cccccccccc}
&&&&&\square&\square&\square&\square&\square\\\
&&&\times&&\square&9&\square&\square&\square\\\ \hline
&&&&2&\square&1&\square&\square&\square\\\
&&&\square&0&\square&7&\square&\square&\\\
&&\square&2&2&\square&\square&\square&&\\\
&\square&\square&\square&2&1&\square&&&\\\
\square&\square&\square&\square&\square&8&&&&\\\ \hline
\square&\square&0&\square&\square&\square&\square&\square&\square&\square
\end{array}$$

### 3

$\dfrac{1}{97}$ の小数第 1 位から小数第 2022 位までの数字をすべて足した値を求めよ。ただし $\dfrac{1}{97}$ の循環節の長さは 96 である。(中学入試予想より)

### 4

$6\times6$ の盤面を以下の条件全てを満たすように 2 つのエリアに分割する方法は何通りか求めよ。

> (条件) 各々のエリアは少なくとも 1 マスあり、どちらのエリアにおいてもそのエリア内の任意のマスはそのエリア内のマスの縦横の移動で同じエリアのどのマスにも移動できる (各々のエリアは辺で連結)。また盤面を $(1,1)$ から $(6,6)$ とあらわすときもし $(a,b)$, $(a,c)$ が同じエリアであるなら $(a,b+1)\dots(a,c-1)$ もその同じエリアであり $(a,b)$, $(c,b)$ が同じエリアであるなら $(a+1,b)\dots(c-1,b)$ もその同じエリアである。

### 5

$1$ から $100$ の整数 100 こを使ってしりとり列を作ったときありうる最長の長さはいくつか。ただし「しりとり列」とは前の整数の 1 の位の値と後の整数の最大の位の値が等しい列のことである。たとえば $1\to 12\to 25\to 54$ はしりとり列である。なお同じ整数は二度使ってはならない。

### 6

$nf^n(m)+mf^m(n)=(n+m+1)^2+1-2f(n+m)$ が成り立つような正の整数全体から正の整数への関数 $f$ を求めよ。

### 7

$a + b + c \leq \dfrac{3}{\sqrt[3]{4}}$ を満たす任意の正の実数 $a,b,c$ に対し以下が成り立つことを示せ. $$\frac{1}{a^2b^2+c} + \frac{1}{b^2c^2+a} + \frac{1}{c^2a^2+b} \geq \frac{3(a^2+b^2+c^2)}{a^3+b^3+c^3+3a^2b^2c^2}$$

### 8

円 $\Gamma$ に四角形 $ABCD$ が内接している。$\Gamma$ の中心を $O$、$AB$, $CD$ の交点を $E$、$AD$, $BC$ の交点を $F$、$AC$, $BD$ の中点をそれぞれ $L$, $M$ とする。$\angle EOF<90\degree$ のとき三角形 $OLM$ の外接円上に 2 点 $X$, $Y$ をとったところ三角形 $OXY$ の垂心が三角形 $OEF$ の外接円上にあった。このとき直線 $XY$ はある定点を通ることを示せ。

### 9

$\dfrac{(pq+1)^p-1}{p^q+2}$ が整数になるような, $p\geq q$ をみたす素数 $p$, $q$ の組を全て求めよ.

### 10

三角形 $ABC$ において, 直線 $AB$ の $B$ に関して $A$ を含まない側に $D$ を, 直線 $AC$ の $C$ に関して $A$ を含まない側に $E$ を, $BD=CE=BC$ を満たすようにとる. また, 直線 $BC$ に対して $A$ と対称な点を $F$, 三角形 $ABC$ の内心を $I$ とする. 三角形 $ADE$ の外接円と三角形 $AFI$ の外接円の交点での各々の接線が直交することを示せ.

### 11

$N+1$ 項全てが正の実数である数列 $\lbrace a_{n}\rbrace$ ($n=0,1\dots N$) は以下の式を満たしている。$$a_0=a_N=1,\quad a_n=\dfrac{a_{n-1}+a_{n+1}}{a_1}\ \text{($0<n<N$ のとき)}$$ 任意の偶数 $N$ に対して $2023(N+2)<K a_{\frac{N}{2}}$ が成り立つような最小の整数 $K$ を求めよ。

### 12

連続関数であり任意の実数 $x$, $y$ に対して $f(f(x)^2+xy)+yf(x+y)=f(f(x)+y)^2$ を満たす関数 $f$ を求めよ。

## 解答

### 1

$51621\times71151=3672885771$

### 2

$60357\times49754=3003002178$

### 3

$0\leq k\leq 48$ を満たす $k$ において小数第 $k$ 位と小数第 $k+48$ 位の和は Midy の定理より $9$ のため $2022=21\times96+6$ に気を付けて $(48\times9)\times21+0+1+3+0+9=\fbox{9085}$.

### 4

エリアの境界線としてありうる通り数を求めればよくその値は $\text{辺の縦横の移動で最短で右下から左上へ行く通り数 ($A$)} + \text{右上から左下へ行く通り数 ($B$)} - 4 \text{ (どちらかのエリアが $0$ マスになる場合)} - 10 \text{ ($A$, $B$ で共通している境界線の場合)} = 2 \times {}\_{12}\mathrm{C}\_{6} - 4 - 10 = \fbox{1834}$.

### 5

$10$, $20$, $30$, $40$, $50$, $60$, $70$, $80$, $90$, $100$ は必ずしりとり列の最後の数字になるためある最長のしりとり列に登場するのはこれらのうちの高々一つ。ゆえに最長のしりとり列は $91$ 以下の長さである。また $91$ の構成例はたとえば $12,21,13,31,14,41\dots,19,91$ があり $2$ がとなりあうところに $23,32,24,42\dots,29,92$ を入れる。ほかのところも同様にしてあとは $1-9,11,22,33,\dots 99$ を適当に差し込み最後に $100$ を付け加えることで構成できる。よって $\boxed{91}$。なお一般に $10^n$ の場合は答えが $9\times10^{n-1}+1$ となる(評価、構成ともにこの解答と同様に行えばよい)

### 6

$P(x,y)$ で $n$ に $x$ を, $m$ に $y$ を代入した式をあらわすこととする。$P(1,1)$ より $(f(1),f(2))=(1,4)(2,3)(3,2)(4,1)$ とわかる。$(1,4)$ のとき $P(1,2)$ で $f(3)=4.5$ となり矛盾。$(3,2)$ のとき $P(2,3)$ を代入して $f(3)$, $f(5)$ のいずれかは整数ではないとわかり矛盾。$(4,1)$ のときは $f(3)=3$, $f(4)=5$ とわかるが $P(1,3)$ で矛盾。ゆえに $(f(1),f(2))=(2,3)$ とわかる。ここで $f(1)=2,\dots,f(k)=k+1$ のとき $f(k+1)=k+2$ となることを示せばよい。$k$ が偶数の時 $P\biggl(\dfrac{k}{2},\dfrac{k}{2}\biggr)$ より示され、$k$ が奇数の時 $P\biggl(\dfrac{k+1}{2},\dfrac{k-1}{2}\biggr)$ より示される。ゆえに $f(n)=n+1$ とわかりこれは十分性を満たす。ゆえに答えは $f(n)=n+1$。

### 7

$$\sum_{\text{cyc}} f(a,b,c) = f(a,b,c)+f(b,c,a)+f(c,a,b)$$ と定義する. 与式の両辺に $a^3+b^3+c^3+3a^2b^2c^2$ を掛けて $\displaystyle\sum_{\text{cyc}} \frac{a^3+b^3-2c^3}{a^2b^2+c} \geq 0$ を示せばよいとわかる。
$$\begin{aligned}
\sum_{\text{cyc}}\frac{a^3+b^3-2c^3}{a^2b^2+c}
&=\sum_{\text{cyc}}\left(\frac{a^3-c^3}{a^2b^2+c}+\frac{b^3-c^3}{a^2b^2+c}\right) \\\
&\geq\sum_{\text{cyc}}(a-b)^2(a^2+ab+b^2)\frac{-c^2\left(\dfrac{3}{\sqrt[3]{4}}-c\right)+1}{(c^2a^2+b)(b^2c^2+a)} \\\
&\geq0
\end{aligned}$$
最後の不等式は, $-c^2 \left (\dfrac{3}{\sqrt[3]{4}} - c \right ) + 1$ は $0\leq c \leq \dfrac{3}{\sqrt[3]{4}}$ において最小値が $0$ であることが微分または相加相乗不等式によって得られることによる. したがって題意は満たされた. 

### 8

ブロカードの定理より $AC$ と $BD$ の交点を $G$ とすると三角形 $EOF$ の垂心が $G$ となり、$\angle EOF$ は鋭角のため $G$ は $EOF$ の内部にある。このとき $OLMXYG$ は共円でありまた $OEY$ の垂心を $H$ とすると $XH\parallel YG$, $YH\parallel XG$ となる。そのため $HXGY$ の交点を $H ^ \prime$ とするとこの点は $EOF$ の九点円上にのる。ここで線分 $EF$ の中点を $P$ とすると $\angle GH ^ \prime P=90\degree$ でありまた $\angle GH ^ \prime Y=90\degree$ なので 4 点 $X$, $H ^ \prime$, $Y$, $P$ は一直線上に並ぶ。ゆえに直線 $XY$ は線分 $EF$ の中点を必ず通ることが示され題意は示された。

### 9

$p=2$ のとき, $p\geq q$ の条件より $q=2$ のみを調べればよく, このとき条件に適する. 以下 $p\geq 3$ とする. ここで次の補題が成り立つ.

{{<alert class="success">}}
**補題**. $n$ を $2$ 以上の整数, $p$ を素数とすると $\dfrac{n^p-1}{n-1}$ の素因数は $p$ であるか $p$ で割って $1$ 余る.
{{</alert>}}

したがって $\dfrac{(pq+1)^p-1}{pq}$ は $p$ または $p$ で割って $1$ 余る素因数を持つ. $\gcd(p^q+2, q) = 1$ のとき, 求めるものは $\dfrac{\frac{(pq+1)^p-1}{q}}{p^q+2}$ が整数になる $(p,q)$ の組である. この分子は $p$ と $p$ で割って $1$ 余る素因数のみを持つのに対し, 分母 $p^q+2$ は $p$ で割って $2$ 余るため, $p$ で割った余りが $1$ でない素因数を持つことが背理法によって示される. よって $\gcd(p^q+2, q) = 1$ のとき$\dfrac{(pq+1)^p-1}{p^q+2}$ は整数になりえない.  $\gcd(p^q+2, q) \neq 1$ のとき,  $p^q+2\equiv p+2 \equiv 0 \pmod{q}$ より $p\geq q$ と併せて, $2$ 以上の整数 $k$ を用いて $p=kq-2$ と表せる. ここで $\dfrac{p^q+2}{q}=\dfrac{(kq-2)^q+2}{q} \equiv \dfrac{2}{q} \not\equiv 0,1 \pmod{kq-2}$ であるから, 先ほどと同様の議論によって $\dfrac{(pq+1)^p-1}{p^q+2}$ は整数になりえない. したがって $p\geq 3$ ならば条件を満たさない. よって求める解は $(p,q)=(2,2)$ である.

### 10

$A$ を中心として反転を行う. このとき, 反転した先において, $\angle ACB=2\angle ACD$ となることから, $D$ は $\angle ACB$ の二等分線と $AB$ の交点である. 同様にして, $E$ は $\angle ABC$ の二等分線と $AC$ の交点である. また, $F$ は三角形 $ABC$ の外心, $I$ は $A$ における三角形 $ABC$ の傍心となっている. このとき, $DE\perp FI$ であることを示せばよい.

ここで, 三角形 $ABC$ の $B$, $C$ における傍心をそれぞれ $I_B$, $I_C$ とおくと, $A$, $B$, $C$ はそれぞれ三角形 $II_BI_C$ において $I$, $I_B$, $I_C$ から対辺におろした垂線の足となっている. また, 三角形 $ABC$ の内心, すなわち三角形 $II_BI_C$ の垂心を $I^\prime$ とおく. このとき, 三角形 $I_BI^\prime I_C$ に着目すると, $F$, $I$ は三角形 $I_BI^\prime I_C$ のそれぞれ九点円の中心, 垂心を表し, したがって直線 $FI$ は三角形 $I_BI^\prime I_C$ のオイラー線である. さらに, 三角形 $I_BI^\prime I_C$ の垂軸は, $I_BI^\prime$ と $CA$, $I_CI^\prime$ と $BA$ の交点, すなわち $E$ と $D$ の交点を通るので, 直線 $DE$ は三角形 $I_BI^\prime I_C$ の垂軸である. したがって, 垂軸とオイラー線は直交する (有名事実) ため, $FI\perp DE$ であるので, 題意が示された.

### 11

与えられた式を変形して $a_1a_n=a_{n-1}+a_{n+1}$ となりこれを $n=1$ から $N-1$ まで足すことで $a_1<2$ とわかる。ここで辺の長さが $1$, $1$, $a_1$ であるような二等辺三角形とその外接円 $O$ を考える。$a_1$ の長さの辺の端点をそれぞれ $A$, $A_1$ とおき残りの頂点を $A_0$ とする。そして $A_1$ を中心とした半径 $1$ の円と $O$ の交点のうち $A_0$ でないものを $A_2$ とする。四角形 $AA_0A_1A_2$ についてトレミーの定理をつかうことで $AA_2=a_2$ がわかる。同様に $A_3\dots A_N$ も定めると $AA_n=a_n$ が成り立つ。ここで $a_N=1$ より $N+1$ 角形 $AA_0A_1\dots A_N$ は一辺の長さが $1$ の正 $N+2$ 角形となる。よって $a_{\frac{N}{2}}$ は円 $O$ の直径の長さに等しいので $\dfrac{N+2}{a_{\frac{N}{2}}}<\pi$ とわかる。また $N$ が大きくなると正 $N+2$ 角形は円に近づくことから求める $m$ は $[2023\pi]=6356$ である。

### 12

以下 $P(a,b)$ で $x=a$, $y=b$ と代入した式をあらわす。いま $f(k)=k$ となる $k$ 全体の集合を $S$ とする。このとき $S$ に元があるかどうかで場合分けする。ある場合, $0\in S$ なら $P(0,y)$ より $f(x)=x\text{ または }0$ とわかる。ここで $f$ の連続性より $f(x)=x$, $f(x)=0$ とわかる (これは十分性を満たす)。また $0$ が含まれないとき $a \in S$ を一つとって $P(a,-a)$ の両辺を $f(0)\neq0$ で割って $1-a=f(0)$ となる。ここで $P(a,0)$ より $a^2\in S$ である。ここで $a\neq1$ とすると上記のような議論で $1-a^2=f(0)$ となり矛盾する。ゆえに $1\in S$。ここで $P(1,y)$ より $f(x)=x$ ($x\neq0$) となるが $0$ でない実数 $x$ を用いて $P(x,-x)$ より $f(0)-xf(0)=f(0)^2$ とわかるが $x$ は $0$ 以外の実数値をとるため $f(0)=0$ である必要があるが $0\in S$ となり条件に反する。次にない場合を考える。このとき連続性より任意の実数 $x$ に対して $f(x)>x$ を満たすか任意の実数 $x$ に対して $f(x)<x$ のどちらかである。前者の場合 $f(t)=0$ となる $t$ があるかどうかで場合分けする。ある場合は $P(t,0)$ より $f(0)>0$ のため $f(0)=1$ となり $P(0,0)$ で $f(1)^2=f(1)$ となるが $f(1)>1$ のため矛盾。存在しない場合連続性より $f(x)$ は常に正実数の値をとる。ここで $P\biggl(x,\dfrac{f(x)^2-x}{1-x}\biggr)$ と $f$ が常に正であることから $\dfrac{f(x)^2+1-2x}{1-x}$ は正。ここで $x=100$ などとすると $f(x)>x$ のため分子は正で分母は負となりこの分数は負となるため矛盾。$f(x)<x$ の場合 $f(t)=0$ となる $t$ がある場合は同様に議論すればよく、ない場合は $P\biggl(x,\dfrac{f(x)^2-x}{1-x}\biggr)$ と $(f(t)=0$ となる $t$ が存在せず $f(x)<x$ のため) $f$ が常に負であることから $\dfrac{f(x)^2+1-2x}{1-x}$ は負。ここで $x=-100$ などとすると分子は正、分母も正となり全体が正になり矛盾。以上の議論より答えは $f(x)=x$ または $f(x)=0$ とわかる。